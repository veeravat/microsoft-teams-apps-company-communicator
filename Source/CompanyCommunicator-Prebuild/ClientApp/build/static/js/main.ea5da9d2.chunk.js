(this["webpackJsonpcompany-communicator"]=this["webpackJsonpcompany-communicator"]||[]).push([[0],{469:function(e,t,a){},610:function(e,t,a){},611:function(e,t,a){},612:function(e,t,a){},686:function(e,t,a){},687:function(e,t,a){},743:function(e,t,a){},745:function(e,t,a){},746:function(e,t,a){},747:function(e,t,a){},748:function(e,t,a){},809:function(e,t,a){},810:function(e,t,a){},814:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(45),i=a.n(r),c=(a(469),a(20)),o=a(21),l=a(29),u=a(37),d=a(447),h=a(42),m=a(14),p=function(){return window.location.origin},j=a(2),b=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).state={url:p()+"/messages?locale={locale}"},s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize(),m.settings.registerOnSaveHandler((function(t){m.settings.setSettings({entityId:"Company_Communicator_App",contentUrl:e.state.url,suggestedDisplayName:"Company Communicator"}),t.notifySuccess()})),m.settings.setValidityState(!0)}},{key:"render",value:function(){return Object(j.jsx)("div",{className:"configContainer",children:Object(j.jsx)("h3",{children:"Please click Save to get started."})})}}]),a}(n.a.Component),g=a(40),f=a(941),O=a(152),v=a(71),x=a(969),k=a(975),S=a(124),y=a(949),C=a(950),w=a(951),z=a(105),T=a(451),N=a(9),M=a(17),L=a(153),D=a(186),I=a(419),A=a(50),E=a.n(A);a(311);L.a.use(I.a).use(D.e).init({fallbackLng:"en-US",interpolation:{escapeValue:!1}});var R=function(e){return e?E()(e).format("l LT"):e},U=function(e,t){var a="",s=window.location.search,n=new URLSearchParams(s).get("locale")||"en-US";if(e&&t){var r=E()(t).diff(E()(e)),i=E.a.duration(r),c=("0"+Math.floor(i.asHours())).slice(-2);a=B(parseInt(c))+E.a.utc(i.asMilliseconds()).locale(n).format(":mm:ss")}return a},B=function(e){var t=window.location.search,a=new URLSearchParams(t).get("locale")||"en-US";return Number(e).toLocaleString(a)},F=L.a,P=a(154),G=a.n(P),q=function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,[{key:"get",value:function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a,s,n,r=arguments;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(r.length>1&&void 0!==r[1])||r[1],s=!(r.length>2&&void 0!==r[2])||r[2],n=r.length>3?r[3]:void 0,e.prev=3,!s){e.next=8;break}return e.next=7,this.setupAuthorizationHeader(n);case 7:n=e.sent;case 8:return e.next=10,G.a.get(t,n);case 10:return e.abrupt("return",e.sent);case 13:if(e.prev=13,e.t0=e.catch(3),!a){e.next=20;break}throw this.handleError(e.t0),e.t0;case 20:throw e.t0;case 21:case"end":return e.stop()}}),e,this,[[3,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a,s,n=arguments;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!(n.length>1&&void 0!==n[1])||n[1],s=n.length>2?n[2]:void 0,e.prev=2,e.next=5,this.setupAuthorizationHeader(s);case 5:return s=e.sent,e.next=8,G.a.delete(t,s);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!a){e.next=18;break}throw this.handleError(e.t0),e.t0;case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(M.a)(Object(N.a)().mark((function e(t,a){var s,n,r=arguments;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=!(r.length>2&&void 0!==r[2])||r[2],n=r.length>3?r[3]:void 0,e.prev=2,e.next=5,this.setupAuthorizationHeader(n);case 5:return n=e.sent,e.next=8,G.a.post(t,a,n);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!s){e.next=18;break}throw this.handleError(e.t0),e.t0;case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(M.a)(Object(N.a)().mark((function e(t,a){var s,n,r=arguments;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=!(r.length>2&&void 0!==r[2])||r[2],n=r.length>3?r[3]:void 0,e.prev=2,e.next=5,this.setupAuthorizationHeader(n);case 5:return n=e.sent,e.next=8,G.a.put(t,a,n);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!s){e.next=18;break}throw this.handleError(e.t0),e.t0;case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleError",value:function(e){if(e.hasOwnProperty("response")){var t=e.response.status;window.location.href=403===t?"/errorpage/403?locale=".concat(F.language):401===t?"/errorpage/401?locale=".concat(F.language):"/errorpage?locale=".concat(F.language)}else window.location.href="/errorpage?locale=".concat(F.language)}},{key:"setupAuthorizationHeader",value:function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m.initialize(),e.abrupt("return",new Promise((function(e,a){var s={successCallback:function(a){t||(t=G.a.defaults),t.headers.Authorization="Bearer ".concat(a),t.headers["Accept-Language"]=F.language,e(t)},failureCallback:function(e){console.error("Error from getAuthToken: ",e),window.location.href="/signin?locale=".concat(F.language)},resources:[]};m.authentication.getAuthToken(s)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),H=new q,_=p()+"/api",W=function(){var e=Object(M.a)(Object(N.a)().mark((function e(){var t;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_+"/sentnotifications",e.next=3,H.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=Object(M.a)(Object(N.a)().mark((function e(){var t;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_+"/draftnotifications",e.next=3,H.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(M.a)(Object(N.a)().mark((function e(){var t;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_+"/groupdata/verifyaccess",e.next=3,H.get(t,!1);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/groupdata/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/groupdata/search/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/exportnotification/export",e.next=3,H.put(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/sentnotifications/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/analytics/reactionscount/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications/"+t,e.next=3,H.delete(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications/duplicates/"+t,e.next=3,H.post(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/sentnotifications",e.next=3,H.post(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications",e.next=3,H.put(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications",e.next=3,H.post(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=Object(M.a)(Object(N.a)().mark((function e(){var t;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_+"/teamdata",e.next=3,H.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications/consentSummaries/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications/previews",e.next=3,H.post(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t,a){var s;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="".concat(_,"/authenticationMetadata/consentUrl?windowLocationOriginDomain=").concat(t,"&loginhint=").concat(a),e.next=3,H.get(s,void 0,!1);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),le=function(e){return{type:"MESSAGE_SELECTED",payload:e}},ue=function(){return function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a,s;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W();case 2:a=e.sent,(s=a.data).forEach((function(e){e.sendingStartedDate=R(e.sendingStartedDate),e.sentDate=R(e.sentDate)})),t({type:"FETCH_MESSAGES",payload:s});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},de=function(){return function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q();case 2:a=e.sent,a.data.forEach((function(e){null!=e.scheduledDateTime&&(e.scheduledDateTime=R(e.scheduledDateTime))})),t({type:"FETCH_DRAFTMESSAGES",payload:a.data});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},he=a(934),me=a(233),pe=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.onOpenTaskModule=function(e,t,a){var s={url:t,title:a,height:530,width:1e3,fallbackUrl:t};m.tasks.startTask(s,(function(e,t){}))},s.duplicateDraftMessage=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),s.localize=s.props.t,s.state={menuOpen:!1},s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){m.initialize()}},{key:"render",value:function(){var e=this,t=[{key:"more",icon:Object(j.jsx)(he.a,{outline:!0}),menuOpen:this.state.menuOpen,active:this.state.menuOpen,indicator:!1,menu:{items:[{key:"status",content:this.localize("ViewStatus"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a=p()+"/viewstatus/"+e.props.message.id+"?locale={locale}";e.onOpenTaskModule(null,a,e.localize("ViewStatus"))}},{key:"duplicate",content:this.localize("Duplicate"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1}),e.duplicateDraftMessage(e.props.message.id).then((function(){e.props.getDraftMessagesList()}))}}]},onMenuOpenChange:function(t,a){var s=a.menuOpen;e.setState({menuOpen:s})}}];return Object(j.jsx)(me.a,{className:"menuContainer",iconOnly:!0,items:t,styles:this.props.styles,title:this.props.title})}}]),a}(n.a.Component),je=Object(f.a)()(pe),be=Object(v.b)((function(e){return{messagesList:e.messagesList}}),{selectMessage:le,getMessagesList:ue,getDraftMessagesList:de})(je),ge=(a(610),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.interval=void 0,s.isOpenTaskModuleAllowed=void 0,s.processLabels=function(){return[{key:"labels",content:Object(j.jsxs)(k.a,{vAlign:"center",fill:!0,gap:"gap.small",children:[Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},grow:1,children:Object(j.jsx)(S.a,{truncated:!0,weight:"bold",content:s.localize("TitleText")})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"12%"},children:Object(j.jsx)(S.a,{})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"12%"},shrink:!1,children:Object(j.jsx)(S.a,{truncated:!0,content:s.localize("Recipients"),weight:"bold"})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},shrink:!1,children:Object(j.jsx)(S.a,{truncated:!0,weight:"bold",content:s.localize("SentBy")})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},children:Object(j.jsx)(S.a,{truncated:!0,content:s.localize("Sent"),weight:"bold"})}),Object(j.jsx)(k.a.Item,{shrink:0,children:Object(j.jsx)(be,{title:""})})]}),styles:{margin:"0.2rem 0.2rem 0 0"}}]},s.renderSendingText=function(e){var t="";switch(e.status){case"Queued":t=s.localize("Queued");break;case"SyncingRecipients":t=s.localize("SyncingRecipients");break;case"InstallingApp":t=s.localize("InstallingApp");break;case"Sending":var a=(e.succeeded?e.succeeded:0)+(e.failed?e.failed:0)+(e.unknown?e.unknown:0);t=s.localize("SendingMessages",{SentCount:B(a),TotalCount:B(e.totalMessageCount)});break;case"Sent":case"Failed":t=""}return Object(j.jsx)(S.a,{truncated:!0,content:t})},s.messageContent=function(e){return Object(j.jsxs)(k.a,{className:"listContainer",vAlign:"center",fill:!0,gap:"gap.small",children:[Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},grow:1,children:Object(j.jsx)(S.a,{truncated:!0,content:e.title})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"12%"},children:s.renderSendingText(e)}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"12%"},shrink:!1,children:Object(j.jsxs)("div",{children:[Object(j.jsxs)(x.a,{content:s.props.t("TooltipSuccess"),calloutProps:{gapSpace:0},children:[Object(j.jsx)(y.a,{xSpacing:"after",className:"succeeded",outline:!0}),Object(j.jsx)("span",{className:"semiBold",children:B(e.succeeded)})]}),Object(j.jsxs)(x.a,{content:s.props.t("TooltipFailure"),calloutProps:{gapSpace:0},children:[Object(j.jsx)(C.a,{xSpacing:"both",className:"failed",outline:!0}),Object(j.jsx)("span",{className:"semiBold",children:B(e.failed)})]}),e.unknown&&Object(j.jsxs)(x.a,{content:"Unknown",calloutProps:{gapSpace:0},children:[Object(j.jsx)(w.a,{xSpacing:"both",className:"unknown",outline:!0}),Object(j.jsx)("span",{className:"semiBold",children:B(e.unknown)})]})]})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},children:Object(j.jsx)(S.a,{truncated:!0,className:"semiBold",content:e.sentBy})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},children:Object(j.jsx)(S.a,{truncated:!0,className:"semiBold",content:e.sentDate})}),Object(j.jsx)(k.a.Item,{shrink:0,children:Object(j.jsx)(be,{message:e,title:""})})]})},s.escFunction=function(e){27!==e.keyCode&&"Escape"!==e.key||m.tasks.submitTask()},s.onOpenTaskModule=function(e,t,a){if(s.isOpenTaskModuleAllowed){s.isOpenTaskModuleAllowed=!1;var n={url:t,title:a,height:530,width:1e3,fallbackUrl:t};m.tasks.startTask(n,(function(e,t){s.isOpenTaskModuleAllowed=!0}))}},s.localize=s.props.t,s.isOpenTaskModuleAllowed=!0,s.state={message:s.props.messagesList,loader:!0},s.escFunction=s.escFunction.bind(Object(g.a)(s)),s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize(),this.props.getMessagesList(),document.addEventListener("keydown",this.escFunction,!1),this.interval=setInterval((function(){e.props.getMessagesList()}),6e4)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1),clearInterval(this.interval)}},{key:"componentWillReceiveProps",value:function(e){this.props!==e&&this.setState({message:e.messagesList,loader:!1})}},{key:"render",value:function(){var e=this,t=0,a=this.processLabels(),s=this.state.message.map((function(a){return{key:++t,content:e.messageContent(a),onClick:function(){var t=p()+"/viewstatus/"+a.id+"?locale={locale}";e.onOpenTaskModule(null,t,e.localize("ViewStatus"))},styles:{margin:"0.2rem 0.2rem 0 0"}}})),n=[].concat(Object(O.a)(a),Object(O.a)(s));return this.state.loader?Object(j.jsx)(z.a,{}):0===this.state.message.length?Object(j.jsx)("div",{className:"results",children:this.localize("EmptySentMessages")}):Object(j.jsx)(T.a,{selectable:!0,items:n,className:"list"})}}]),a}(s.Component)),fe=Object(f.a)()(ge),Oe=Object(v.b)((function(e){return{messagesList:e.messagesList}}),{selectMessage:le,getMessagesList:ue,getDraftMessagesList:de})(fe),ve=a(965),xe=(a(611),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.onOpenTaskModule=function(e,t,a){var n={url:t,title:a,height:530,width:1e3,fallbackUrl:t};m.tasks.startTask(n,(function(e,t){s.props.getDraftMessagesList().then((function(){s.props.getMessagesList()}))}))},s.duplicateDraftMessage=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),s.deleteDraftMessage=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ee(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),s.localize=s.props.t,s.state={teamsChannelId:"",teamsTeamId:"",menuOpen:!1},s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize(),m.getContext((function(t){e.setState({teamsTeamId:t.teamId,teamsChannelId:t.channelId})}))}},{key:"render",value:function(){var e=this,t=[{key:"more",icon:Object(j.jsx)(he.a,{outline:!0}),menuOpen:this.state.menuOpen,active:this.state.menuOpen,indicator:!1,menu:{items:[{key:"send",content:this.localize("Send"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a=p()+"/sendconfirmation/"+e.props.message.id+"?locale={locale}";e.onOpenTaskModule(null,a,e.localize("SendConfirmation"))}},{key:"preview",content:this.localize("PreviewInThisChannel"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a={draftNotificationId:e.props.message.id,teamsTeamId:e.state.teamsTeamId,teamsChannelId:e.state.teamsChannelId};ce(a).then((function(e){return e.status})).catch((function(e){return e}))}},{key:"edit",content:this.localize("Edit"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a=p()+"/newmessage/"+e.props.message.id+"?locale={locale}";e.onOpenTaskModule(null,a,e.localize("EditMessage"))}},{key:"duplicate",content:this.localize("Duplicate"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1}),e.duplicateDraftMessage(e.props.message.id).then((function(){e.props.getDraftMessagesList()}))}},{key:"delete",content:this.localize("Delete"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1}),e.deleteDraftMessage(e.props.message.id).then((function(){e.props.getDraftMessagesList()}))}}]},onMenuOpenChange:function(t,a){var s=a.menuOpen;e.setState({menuOpen:s})}}];return Object(j.jsx)(me.a,{className:"menuContainer",iconOnly:!0,items:t,styles:this.props.styles,title:this.props.title})}}]),a}(n.a.Component)),ke=Object(f.a)()(xe),Se=Object(v.b)((function(e){return{messages:e.draftMessagesList,selectedMessage:e.selectedMessage}}),{selectMessage:le,getDraftMessagesList:de,getMessagesList:ue})(ke),ye=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.interval=void 0,s.isOpenTaskModuleAllowed=void 0,s.processLabels=function(){return[{key:"labels",content:Object(j.jsxs)(k.a,{vAlign:"center",fill:!0,gap:"gap.small",children:[Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},grow:1,children:Object(j.jsx)(S.a,{truncated:!0,weight:"bold",content:s.localize("TitleText")})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},children:Object(j.jsx)(S.a,{})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},shrink:!1,children:Object(j.jsx)(S.a,{truncated:!0,weight:"bold",content:s.localize("ModifiedBy")})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},children:Object(j.jsx)(S.a,{truncated:!0,weight:"bold",content:s.localize("ScheduledDateTimeText")})}),Object(j.jsx)(k.a.Item,{shrink:0,children:Object(j.jsx)(S.a,{})})]}),styles:{margin:"0.2rem 0.2rem 0 0"}}]},s.onOpenTaskModule=function(e,t,a){if(s.isOpenTaskModuleAllowed){s.isOpenTaskModuleAllowed=!1;var n={url:t,title:a,height:530,width:1e3,fallbackUrl:t};m.tasks.startTask(n,(function(e,t){s.props.getDraftMessagesList().then((function(){s.props.getMessagesList(),s.isOpenTaskModuleAllowed=!0}))}))}},Object(ve.a)(),s.localize=s.props.t,s.isOpenTaskModuleAllowed=!0,s.state={message:e.messages,itemsAccount:s.props.messages.length,loader:!0,teamsTeamId:"",teamsChannelId:""},s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize(),m.getContext((function(t){e.setState({teamsTeamId:t.teamId,teamsChannelId:t.channelId})})),this.props.getDraftMessagesList(),this.interval=setInterval((function(){e.props.getDraftMessagesList()}),6e4)}},{key:"componentWillReceiveProps",value:function(e){this.setState({message:e.messages,loader:!1})}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this,t=0,a=this.processLabels(),s=this.state.message.map((function(a){return{key:++t,content:Object(j.jsxs)(k.a,{vAlign:"center",fill:!0,gap:"gap.small",children:[Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},grow:1,children:Object(j.jsx)(S.a,{truncated:!0,content:a.title})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},shrink:!1,children:Object(j.jsx)(S.a,{truncated:!0,className:"semiBold",content:a.author})}),Object(j.jsx)(k.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},children:Object(j.jsx)(S.a,{truncated:!0,className:"semiBold",content:a.scheduledDateTime})}),Object(j.jsx)(k.a.Item,{shrink:0,align:"end",children:Object(j.jsx)(Se,{message:a,title:""})})]}),styles:{margin:"0.2rem 0.2rem 0 0"},onClick:function(){var t=p()+"/newmessage/"+a.id+"?locale={locale}";e.onOpenTaskModule(null,t,e.localize("EditMessage"))}}})),n=[].concat(Object(O.a)(a),Object(O.a)(s));return this.state.loader?Object(j.jsx)(z.a,{}):0===this.state.message.length?Object(j.jsx)("div",{className:"results",children:this.localize("EmptyDraftMessages")}):Object(j.jsx)(T.a,{selectable:!0,items:n,className:"list"})}}]),a}(s.Component),Ce=Object(f.a)()(ye),we=Object(v.b)((function(e){return{messages:e.draftMessagesList,selectedMessage:e.selectedMessage}}),{selectMessage:le,getDraftMessagesList:de,getMessagesList:ue})(Ce),ze=(a(612),a(235)),Te=a(971),Ne=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.onNewMessage=function(){var e={url:s.state.url,title:s.localize("NewMessage"),height:530,width:1e3,fallbackUrl:s.state.url};m.tasks.startTask(e,(function(e,t){s.props.getDraftMessagesList()}))},s.localize=s.props.t,s.state={url:p()+"/newmessage?locale={locale}"},s.escFunction=s.escFunction.bind(Object(g.a)(s)),s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){m.initialize(),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"escFunction",value:function(e){27!==e.keyCode&&"Escape"!==e.key||m.tasks.submitTask()}},{key:"render",value:function(){var e=[{title:this.localize("DraftMessagesSectionTitle"),content:{key:"sent",content:Object(j.jsx)(we,{})}},{title:this.localize("SentMessagesSectionTitle"),content:{key:"draft",content:Object(j.jsx)(Oe,{})}}];return Object(j.jsxs)(k.a,{className:"tabContainer",column:!0,fill:!0,gap:"gap.small",children:[Object(j.jsx)(k.a,{className:"newPostBtn",hAlign:"end",vAlign:"end",children:Object(j.jsx)(ze.a,{content:this.localize("NewMessage"),onClick:this.onNewMessage,primary:!0})}),Object(j.jsx)(k.a,{className:"messageContainer",children:Object(j.jsx)(k.a.Item,{grow:1,children:Object(j.jsx)(Te.a,{defaultActiveIndex:[0,1],panels:e})})})]})}}]),a}(s.Component),Me=Object(f.a)()(Ne),Le=Object(v.b)((function(e){return{messages:e.draftMessagesList}}),{getDraftMessagesList:de})(Me),De=a(78),Ie=a(188),Ae=a(90),Ee=a(234),Re=a(976),Ue=a(977),Be=a(452),Fe=a(453),Pe=a(438),Ge=(a(686),a(687),a(439)),qe=a.n(Ge);Ae.AdaptiveCard.onProcessMarkdown=function(e,t){t.outputHtml=(new qe.a).render(e),t.didProcess=!0};var He=function(e){return{type:"AdaptiveCard",body:[{type:"TextBlock",weight:"Bolder",text:e("TitleText"),size:"ExtraLarge",wrap:!0},{type:"Image",spacing:"Default",url:"",size:"Stretch",width:"400px",altText:""},{type:"TextBlock",text:"",wrap:!0},{type:"TextBlock",wrap:!0,size:"Small",weight:"Lighter",text:""}],$schema:"https://adaptivecards.io/schemas/adaptive-card.json",version:"1.0"}},_e=function(e,t){e.body[0].text=t},We=function(e,t){e.body[1].url=t},Qe=function(e,t){e.body[2].text=t},Ve=function(e,t){e.body[3].text=t},Je=function(e,t,a){t&&a?e.actions=[{type:"Action.OpenUrl",title:t,url:a}]:delete e.actions},Xe=a(440),$e=a.n(Xe),Ke=Object(o.a)((function e(){Object(c.a)(this,e)}));Ke.makeInitialImage=function(e){var t=document.createElement("canvas");t.style.display="none",t.width=32,t.height=32,document.body.appendChild(t);var a=t.getContext("2d");if(a){var s=(new $e.a).hex(e);a.fillStyle=s,a.fillRect(0,0,t.width,t.height),a.font="16px Arial",a.fillStyle="#fff";var n=e.split(" "),r=n.length,i=n[0][0];if(r>1){var c=i+n[r-1][0];a.fillText(c.toUpperCase(),3,23)}else a.fillText(i.toUpperCase(),10,23);var o=t.toDataURL();return document.body.removeChild(t),o}return""};var Ye,Ze=a(60),et=a(967),tt=a(957),at=a(431);a(743);!function(e){e.Rtl="rtl",e.Ltr="ltr",e.Auto="auto"}(Ye||(Ye={}));var st=function(e){var t=Object(at.a)().t,a=s.useState(!1),n=Object(Ze.a)(a,2),r=n[0],i=n[1],c=s.useState(e.hours.toString().padStart(2,"0")+":"+e.minutes.toString().padStart(2,"0")),o=Object(Ze.a)(c,2),l=o[0],u=o[1],d=s.useState(e.hours.toString().padStart(2,"0")),h=Object(Ze.a)(d,2),m=h[0],p=h[1],b=s.useState(e.minutes.toString().padStart(2,"0")),g=Object(Ze.a)(b,2),f=g[0],O=g[1],v=s.useState(e.minHours),x=Object(Ze.a)(v,2),y=x[0],C=x[1],w=s.useState(e.minMinutes),z=Object(Ze.a)(w,2),T=(z[0],z[1]),N=[],M=[];s.useEffect((function(){p(e.hours.toString().padStart(2,"0")),u(e.hours.toString().padStart(2,"0")+":"+e.minutes.toString().padStart(2,"0"))}),[e.hours]),s.useEffect((function(){O(e.minutes.toString().padStart(2,"0")),u(e.hours.toString().padStart(2,"0")+":"+e.minutes.toString().padStart(2,"0"))}),[e.minutes]),s.useEffect((function(){C(e.minHours)}),[e.minHours]),s.useEffect((function(){T(e.minMinutes)}),[e.minMinutes]);for(var L=y||0;L<24;L++)N.push(L.toString().padStart(2,"0"));for(L=1;L<12;L++)M.push((5*L).toString().padStart(2,"0"));var D={onAdd:function(e){return e&&p(e),""}},I={onAdd:function(e){return e&&O(e),""}},A=Object(j.jsxs)("div",{className:"timepicker-popup-style",children:[Object(j.jsxs)(k.a,{gap:"gap.small",children:[Object(j.jsx)(k.a.Item,{size:"size.half",children:Object(j.jsx)(S.a,{size:e.dir===Ye.Rtl?"medium":"small",content:t("hourPlaceholder")})}),Object(j.jsx)(k.a.Item,{size:"size.half",className:e.dir===Ye.Rtl?"rtl-right-margin-large":"",children:Object(j.jsx)(S.a,{size:e.dir===Ye.Rtl?"medium":"small",content:t("minutePlaceholder")})})]}),Object(j.jsxs)(k.a,{gap:"gap.small",styles:{marginTop:"0.5rem"},children:[Object(j.jsx)(k.a.Item,{children:Object(j.jsx)(Be.a,{className:"timepicker-dropdown",items:N,value:m,placeholder:t("hourPlaceholder"),getA11ySelectionMessage:D})}),Object(j.jsx)(k.a.Item,{children:Object(j.jsx)(Be.a,{className:e.dir===Ye.Rtl?"timepicker-dropdown rtl-right-margin-small":"timepicker-dropdown",value:f,items:M,placeholder:t("minutePlaceholder"),getA11ySelectionMessage:I})})]})]});return Object(j.jsx)(et.a,{className:"timepicker-popup-style",open:r,trapFocus:!0,onOpenChange:function(t,a){var s=a.open;i(s),s||(u(m+":"+f),e.onPickerClose(parseInt(m),parseInt(f)))},trigger:Object(j.jsx)(Ee.a,{style:{width:"100px"},className:e.dir===Ye.Rtl?"rtl-left-margin-small":"",disabled:e.isDisabled,fluid:!0,value:l,icon:Object(j.jsx)(tt.a,{}),iconPosition:e.dir===Ye.Rtl?"start":"end"}),content:A})},nt=st;st.defaultProps={hours:0,minutes:0};var rt=a(963),it=a(973),ct=a(974);a(745);Object(ve.a)();var ot={months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["S","M","T","W","T","F","S"],goToToday:""},lt=function(e){return e?E.a.utc(e).local().format("LL"):""},ut=function(e){e.theme;ot.months=E.a.months(),ot.shortMonths=E.a.monthsShort(),ot.days=E.a.weekdays(),ot.shortDays=E.a.weekdaysShort();var t=Object(s.useState)(e.selectedDate),a=Object(Ze.a)(t,2),n=a[0],r=a[1],i=Object(s.useState)(e.minDate),c=Object(Ze.a)(i,2),o=c[0],l=c[1];s.useEffect((function(){r(e.selectedDate)}),[e.selectedDate]),s.useEffect((function(){l(e.minDate)}),[e.minDate]);return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(k.a,{gap:"gap.small",children:Object(j.jsx)(it.a,{className:"full-width",dir:"ltr",children:Object(j.jsx)(ct.a,Object(De.a)(Object(De.a)({},undefined),{},{children:Object(j.jsx)(rt.a,{className:"default-datepicker",label:"",strings:ot,formatDate:lt,showMonthPickerAsOverlay:!0,minDate:o,isMonthPickerVisible:!0,value:n,onSelectDate:function(t){var a=E()(t).set("hour",E()().hour()).set("minute",E()().minute()).set("second",E()().second());e.onDateSelect(a.toDate()),r(a.toDate())},disabled:e.disableSelection})}))})})})},dt=["name"],ht=["name"],mt=["name"],pt=["name"],jt=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.card=void 0,n.fileInput=void 0,n.makeDropdownItems=function(e){var t=[];return e&&e.forEach((function(e){t.push({key:e.id,header:e.name,content:e.mail,image:Ke.makeInitialImage(e.name),team:{id:e.id}})})),t},n.makeDropdownItemList=function(e,t){var a=[];return e.forEach((function(e){return a.push("string"!==typeof e?e:{key:t.find((function(t){return t.id===e})).id,header:t.find((function(t){return t.id===e})).name,image:Ke.makeInitialImage(t.find((function(t){return t.id===e})).name),team:{id:e}})})),a},n.setDefaultCard=function(e){var t=n.localize("TitleText"),a=n.localize("Summary"),s=n.localize("Author1"),r=n.localize("ButtonTitle");_e(e,t);var i=p()+"/image/imagePlaceholder.png";We(e,i),Qe(e,a),Ve(e,s),Je(e,r,"https://adaptivecards.io")},n.getTeamList=Object(M.a)(Object(N.a)().mark((function e(){var t;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re();case 3:t=e.sent,n.setState({teams:t.data}),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),n.setGroupAccess=Object(M.a)(Object(N.a)().mark((function e(){return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V().then((function(){n.setState({groupAccess:!0})})).catch((function(e){if(403!==e.response.status)throw e;n.setState({groupAccess:!1})}));case 2:case"end":return e.stop()}}),e)}))),n.getGroupData=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J(t);case 3:a=e.sent,n.setState({groups:a.data}),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),n.getItem=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a,s,r;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z(t);case 3:a=e.sent,s=a.data,r="teams",s.rosters.length>0?r="rosters":s.groups.length>0?r="groups":s.allUsers&&(r="allUsers"),console.log(s.scheduledDateTime),n.setState({teamsOptionSelected:s.teams.length>0,selectedTeamsNum:s.teams.length,rostersOptionSelected:s.rosters.length>0,selectedRostersNum:s.rosters.length,groupsOptionSelected:s.groups.length>0,selectedGroupsNum:s.groups.length,selectedRadioBtn:r,selectedTeams:s.teams,selectedRosters:s.rosters,selectedGroups:s.groups,selectedRequestReadReceipt:s.ack,selectedInlineTranslation:s.inlineTranslation,selectedScheduledDateTime:null!==s.scheduledDateTime?new Date(s.scheduledDateTime):s.scheduledDateTime,selectedDelayDelivery:null!==s.scheduledDateTime,fullWidth:s.fullWidth,notifyUser:s.notifyUser}),_e(n.card,s.title),We(n.card,s.imageLink),Qe(n.card,s.summary),Ve(n.card,s.author),Je(n.card,s.buttonTitle,s.buttonLink),n.setState({title:s.title,summary:s.summary,btnLink:s.buttonLink,imageLink:s.imageLink,btnTitle:s.buttonTitle,author:s.author,allUsersOptionSelected:s.allUsers,loader:!1},(function(){n.updateCard()})),e.next=20;break;case 17:return e.prev=17,e.t0=e.catch(0),e.abrupt("return",e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}(),n._handleReaderLoaded=function(e){var t=e.target.result;console.log(t)},n.handleUploadClick=function(e){n.fileInput.current&&n.fileInput.current.click()},n.onRequestReadReceiptChanged=function(e,t){n.setState({selectedRequestReadReceipt:t.checked})},n.onDelayDeliveryChanged=function(e,t){n.setState({selectedDelayDelivery:t.checked})},n.onInlineTranslationChanged=function(e,t){n.setState({selectedInlineTranslation:t.checked})},n.onDeliveryTimeChange=function(e,t){var a=void 0===n.state.selectedScheduledDateTime?new Date((new Date).setHours(e,t)):new Date(new Date(n.state.selectedScheduledDateTime).setHours(e,t));n.setState({selectedScheduledDateTime:a})},n.onDeliveryDateChangedOld=function(e,t){console.log(n.state.selectedScheduledDateTime),console.log(t.value),n.setState({selectedScheduledDateTime:t.value})},n.onDeliveryDateChanged=function(e){console.log(e),n.setState({selectedScheduledDateTime:e})},n.onGroupSelected=function(e,t){n.setState({selectedRadioBtn:t.value,teamsOptionSelected:"teams"===t.value,rostersOptionSelected:"rosters"===t.value,groupsOptionSelected:"groups"===t.value,allUsersOptionSelected:"allUsers"===t.value,selectedTeams:"teams"===t.value?n.state.selectedTeams:[],selectedTeamsNum:"teams"===t.value?n.state.selectedTeamsNum:0,selectedRosters:"rosters"===t.value?n.state.selectedRosters:[],selectedRostersNum:"rosters"===t.value?n.state.selectedRostersNum:0,selectedGroups:"groups"===t.value?n.state.selectedGroups:[],selectedGroupsNum:"groups"===t.value?n.state.selectedGroupsNum:0})},n.isSaveBtnDisabled=function(){var e=n.state.teamsOptionSelected&&0!==n.state.selectedTeamsNum||!n.state.teamsOptionSelected,t=n.state.rostersOptionSelected&&0!==n.state.selectedRostersNum||!n.state.rostersOptionSelected,a=n.state.groupsOptionSelected&&0!==n.state.selectedGroupsNum||!n.state.groupsOptionSelected,s=!n.state.teamsOptionSelected&&!n.state.rostersOptionSelected&&!n.state.groupsOptionSelected&&!n.state.allUsersOptionSelected;return!e||!t||!a||s},n.isNextBtnDisabled=function(){var e=n.state.title,t=n.state.btnTitle,a=n.state.btnLink;return!(e&&(t&&a||!t&&!a)&&""===n.state.errorImageUrlMessage&&""===n.state.errorButtonUrlMessage)},n.getItems=function(){var e=[];if(n.state.teams){var t=n.state.teams;"allUsers"!==n.state.selectedRadioBtn&&("teams"===n.state.selectedRadioBtn?n.state.teams.filter((function(e){return n.state.selectedTeams.findIndex((function(t){return t.team.id===e.id}))<0})):"rosters"===n.state.selectedRadioBtn&&n.state.teams.filter((function(e){return n.state.selectedRosters.findIndex((function(t){return t.team.id===e.id}))<0}))),t.forEach((function(t){e.push({key:t.id,header:t.name,content:t.mail,image:Ke.makeInitialImage(t.name),team:{id:t.id}})}))}return e},n.onTeamsChange=function(e,t){t.value.length>a.MAX_SELECTED_TEAMS_NUM||n.setState({selectedTeams:t.value,selectedTeamsNum:t.value.length,selectedRosters:[],selectedRostersNum:0,selectedGroups:[],selectedGroupsNum:0})},n.onRostersChange=function(e,t){t.value.length>a.MAX_SELECTED_TEAMS_NUM||n.setState({selectedRosters:t.value,selectedRostersNum:t.value.length,selectedTeams:[],selectedTeamsNum:0,selectedGroups:[],selectedGroupsNum:0})},n.onGroupsChange=function(e,t){n.setState({selectedGroups:t.value,selectedGroupsNum:t.value.length,groups:[],selectedTeams:[],selectedTeamsNum:0,selectedRosters:[],selectedRostersNum:0})},n.onGroupSearch=function(e,t){return e.filter((function(e){return e.header&&-1!==e.header.toLowerCase().indexOf(t.toLowerCase())||e.content&&-1!==e.content.toLowerCase().indexOf(t.toLowerCase())}))},n.onGroupSearchQueryChange=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t,a){var s,r;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.searchQuery){e.next=4;break}n.setState({groups:[],noResultMessage:""}),e.next=24;break;case 4:if(!(a.searchQuery&&a.searchQuery.length<=2)){e.next=8;break}n.setState({loading:!1,noResultMessage:n.localize("NoMatchMessage")}),e.next=24;break;case 8:if(!(a.searchQuery&&a.searchQuery.length>2)){e.next=24;break}if(!(a.items&&a.items.find((function(e){return e.header.toLowerCase()===a.searchQuery.toLowerCase()})))){e.next=12;break}return e.abrupt("return");case 12:return n.setState({loading:!0,noResultMessage:""}),e.prev=13,s=encodeURIComponent(a.searchQuery),e.next=17,X(s);case 17:r=e.sent,n.setState({groups:r.data,loading:!1,noResultMessage:n.localize("NoMatchMessage")}),e.next=24;break;case 21:return e.prev=21,e.t0=e.catch(13),e.abrupt("return",e.t0);case 24:case"end":return e.stop()}}),e,null,[[13,21]])})));return function(t,a){return e.apply(this,arguments)}}(),n.onSave=function(){document.getElementsByClassName("sendingLoader")[0].classList.remove("hiddenLoader");var e=[],t=[],a=[];n.state.selectedTeams.forEach((function(t){return e.push(t.team.id)})),n.state.selectedRosters.forEach((function(e){return t.push(e.team.id)})),n.state.selectedGroups.forEach((function(e){return a.push(e.team.id)}));var s={id:n.state.messageId,title:n.state.title,imageLink:n.state.imageLink,summary:n.state.summary,author:n.state.author,buttonTitle:n.state.btnTitle,buttonLink:n.state.btnLink,teams:e,rosters:t,groups:a,allUsers:n.state.allUsersOptionSelected,ack:n.state.selectedRequestReadReceipt,inlineTranslation:n.state.selectedInlineTranslation,scheduledDateTime:n.state.selectedDelayDelivery?n.state.selectedScheduledDateTime:void 0,fullWidth:n.state.fullWidth,notifyUser:n.state.notifyUser};n.state.exists?n.editDraftMessage(s).then((function(){m.tasks.submitTask()})):n.postDraftMessage(s).then((function(){m.tasks.submitTask()}))},n.editDraftMessage=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),n.postDraftMessage=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ne(t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),n.onNext=function(e){n.setState({page:"AudienceSelection"},(function(){n.updateCard()}))},n.onBack=function(e){n.setState({page:"CardCreation"},(function(){n.updateCard()}))},n.onTitleChanged=function(e){var t=!e.target.value&&!n.state.imageLink&&!n.state.summary&&!n.state.author&&!n.state.btnTitle&&!n.state.btnLink;_e(n.card,e.target.value),We(n.card,n.state.imageLink),Qe(n.card,n.state.summary),Ve(n.card,n.state.author),Je(n.card,n.state.btnTitle,n.state.btnLink),n.setState({title:e.target.value,card:n.card},(function(){t&&n.setDefaultCard(n.card),n.updateCard()}))},n.onImageLinkChanged=function(e){var t=e.target.value.toLowerCase();""===t||t.startsWith("https://")||t.startsWith("data:image/png;base64,")||t.startsWith("data:image/jpeg;base64,")||t.startsWith("data:image/gif;base64,")?n.setState({errorImageUrlMessage:""}):n.setState({errorImageUrlMessage:n.localize("ErrorURLMessage")});var a=!n.state.title&&!e.target.value&&!n.state.summary&&!n.state.author&&!n.state.btnTitle&&!n.state.btnLink;_e(n.card,n.state.title),We(n.card,e.target.value),Qe(n.card,n.state.summary),Ve(n.card,n.state.author),Je(n.card,n.state.btnTitle,n.state.btnLink),n.setState({imageLink:e.target.value,card:n.card},(function(){a&&n.setDefaultCard(n.card),n.updateCard()}))},n.onSummaryChanged=function(e){var t=!n.state.title&&!n.state.imageLink&&!e.target.value&&!n.state.author&&!n.state.btnTitle&&!n.state.btnLink;_e(n.card,n.state.title),We(n.card,n.state.imageLink),Qe(n.card,e.target.value),Ve(n.card,n.state.author),Je(n.card,n.state.btnTitle,n.state.btnLink),n.setState({summary:e.target.value,card:n.card},(function(){t&&n.setDefaultCard(n.card),n.updateCard()}))},n.onAuthorChanged=function(e){var t=!n.state.title&&!n.state.imageLink&&!n.state.summary&&!e.target.value&&!n.state.btnTitle&&!n.state.btnLink;_e(n.card,n.state.title),We(n.card,n.state.imageLink),Qe(n.card,n.state.summary),Ve(n.card,e.target.value),Je(n.card,n.state.btnTitle,n.state.btnLink),n.setState({author:e.target.value,card:n.card},(function(){t&&n.setDefaultCard(n.card),n.updateCard()}))},n.onBtnTitleChanged=function(e){var t=!n.state.title&&!n.state.imageLink&&!n.state.summary&&!n.state.author&&!e.target.value&&!n.state.btnLink;_e(n.card,n.state.title),We(n.card,n.state.imageLink),Qe(n.card,n.state.summary),Ve(n.card,n.state.author),e.target.value&&n.state.btnLink?(Je(n.card,e.target.value,n.state.btnLink),n.setState({btnTitle:e.target.value,card:n.card},(function(){t&&n.setDefaultCard(n.card),n.updateCard()}))):(delete n.card.actions,n.setState({btnTitle:e.target.value},(function(){t&&n.setDefaultCard(n.card),n.updateCard()})))},n.onBtnLinkChanged=function(e){""===e.target.value||e.target.value.toLowerCase().startsWith("https://")?n.setState({errorButtonUrlMessage:""}):n.setState({errorButtonUrlMessage:n.localize("ErrorURLMessage")});var t=!n.state.title&&!n.state.imageLink&&!n.state.summary&&!n.state.author&&!n.state.btnTitle&&!e.target.value;_e(n.card,n.state.title),Qe(n.card,n.state.summary),Ve(n.card,n.state.author),We(n.card,n.state.imageLink),n.state.btnTitle&&e.target.value?(Je(n.card,n.state.btnTitle,e.target.value),n.setState({btnLink:e.target.value,card:n.card},(function(){t&&n.setDefaultCard(n.card),n.updateCard()}))):(delete n.card.actions,n.setState({btnLink:e.target.value},(function(){t&&n.setDefaultCard(n.card),n.updateCard()})))},n.updateCard=function(){var e=new Ae.AdaptiveCard;e.parse(n.state.card);var t=e.render(),a=document.getElementsByClassName("adaptiveCardContainer")[0].firstChild;null!=a?a.replaceWith(t):document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(t);var s=n.state.btnLink;e.onExecuteAction=function(e){window.open(s,"_blank")}},Object(ve.a)(),n.localize=n.props.t,n.card=He(n.localize),n.setDefaultCard(n.card),n.state={title:"",summary:"",author:"",btnLink:"",imageLink:"",btnTitle:"",card:n.card,page:"CardCreation",teamsOptionSelected:!0,rostersOptionSelected:!1,allUsersOptionSelected:!1,groupsOptionSelected:!1,messageId:"",loader:!0,groupAccess:!1,loading:!1,noResultMessage:"",unstablePinned:!0,selectedTeamsNum:0,selectedRostersNum:0,selectedGroupsNum:0,selectedRadioBtn:"teams",selectedTeams:[],selectedRosters:[],selectedGroups:[],selectedRequestReadReceipt:!1,selectedInlineTranslation:!1,selectedScheduledDateTime:new Date,errorImageUrlMessage:"",errorButtonUrlMessage:""},n.fileInput=s.createRef(),n.handleImageSelection=n.handleImageSelection.bind(Object(g.a)(n)),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=Object(M.a)(Object(N.a)().mark((function e(){var t,a=this;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.initialize(),document.addEventListener("keydown",this.escFunction,!1),t=this.props.match.params,this.setGroupAccess(),this.getTeamList().then((function(){if("id"in t){var e=t.id;a.getItem(e).then((function(){var t=a.makeDropdownItemList(a.state.selectedTeams,a.state.teams),s=a.makeDropdownItemList(a.state.selectedRosters,a.state.teams);a.setState({exists:!0,messageId:e,selectedTeams:t,selectedRosters:s})})),a.getGroupData(e).then((function(){var e=a.makeDropdownItems(a.state.groups);a.setState({selectedGroups:e})}))}else a.setState({exists:!1,loader:!1},(function(){var e=new Ae.AdaptiveCard;e.parse(a.state.card);var t=e.render();if(document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(t),a.state.btnLink){var s=a.state.btnLink;e.onExecuteAction=function(e){window.open(s,"_blank")}}}))}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getGroupItems",value:function(){if(this.state.groups)return this.makeDropdownItems(this.state.groups);return[]}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"handleImageSelection",value:function(){var e=this,t=this.fileInput.current.files[0],a=t.type;console.log("file.size: "+t.size),console.log("mimeType: "+a);var s=new FileReader;s.readAsDataURL(t),s.onload=function(){var t=new Image;t.src=s.result;var n=s.result;console.log("resizedImageAsBase64: "+n.length),t.onload=function(e){var s=1024;if(console.log("image.width: "+t.width),console.log("image.height: "+t.height),console.log("image.src.length: "+t.src.length),t.width>s){var r=document.createElement("canvas");r.width=s,r.height=~~(t.height*(s/t.width));var i=r.getContext("2d",{alpha:!1});if(!i)return;i.drawImage(t,0,0,r.width,r.height),n=r.toDataURL(a),console.log("resizedImageAsBase64: after resizing: "+n.length)}},We(e.card,n),e.updateCard(),e.setState({imageLink:n})},s.onerror=function(e){}}},{key:"render",value:function(){var e=this;return this.state.loader?Object(j.jsx)("div",{className:"Loader",children:Object(j.jsx)(z.a,{})}):"CardCreation"===this.state.page?Object(j.jsx)("div",{className:"taskModule",children:Object(j.jsxs)(k.a,{column:!0,className:"formContainer",vAlign:"stretch",gap:"gap.small",children:[Object(j.jsxs)(k.a,{className:"scrollableContent",children:[Object(j.jsx)(k.a.Item,{size:"size.half",children:Object(j.jsxs)(k.a,{column:!0,className:"formContentContainer",children:[Object(j.jsx)(Ee.a,{className:"inputField",value:this.state.title,label:this.localize("TitleText"),placeholder:this.localize("PlaceHolderTitle"),onChange:this.onTitleChanged,autoComplete:"off",fluid:!0}),Object(j.jsxs)(k.a,{gap:"gap.small",vAlign:"end",children:[Object(j.jsx)(Ee.a,{fluid:!0,className:"inputField",value:this.state.imageLink,label:this.localize("ImageURL"),placeholder:this.localize("ImageURL"),onChange:this.onImageLinkChanged,error:!(""===this.state.errorImageUrlMessage),autoComplete:"off"}),Object(j.jsx)(k.a.Item,{push:!0,children:Object(j.jsx)(ze.a,{onClick:this.handleUploadClick,size:"medium",className:"inputField",content:this.localize("UploadImage"),iconPosition:"before"})}),Object(j.jsx)("input",{type:"file",accept:".jpg, .jpeg, .png, .gif",style:{display:"none"},multiple:!1,onChange:this.handleImageSelection,ref:this.fileInput}),Object(j.jsx)(S.a,{className:""===this.state.errorImageUrlMessage?"hide":"show",error:!0,size:"small",content:this.state.errorImageUrlMessage})]}),Object(j.jsxs)("div",{className:"textArea",children:[Object(j.jsx)(S.a,{content:this.localize("Summary")}),Object(j.jsx)(Pe.SimpleMarkdownEditor,{textAreaID:"summaryTextArea",enabledButtons:{strike:!1,code:!1,quote:!1,h1:!1,h2:!1,h3:!1,image:!1}}),Object(j.jsx)(Re.a,{autoFocus:!0,placeholder:this.localize("Summary"),value:this.state.summary,onChange:this.onSummaryChanged,id:"summaryTextArea",fluid:!0})]}),Object(j.jsx)(Ee.a,{className:"inputField",value:this.state.author,label:this.localize("Author"),placeholder:this.localize("Author"),onChange:this.onAuthorChanged,autoComplete:"off",fluid:!0}),Object(j.jsx)(Ee.a,{className:"inputField",fluid:!0,value:this.state.btnTitle,label:this.localize("ButtonTitle"),placeholder:this.localize("ButtonTitle"),onChange:this.onBtnTitleChanged,autoComplete:"off"}),Object(j.jsx)(Ee.a,{className:"inputField",fluid:!0,value:this.state.btnLink,label:this.localize("ButtonURL"),placeholder:this.localize("ButtonURL"),onChange:this.onBtnLinkChanged,error:!(""===this.state.errorButtonUrlMessage),autoComplete:"off"}),Object(j.jsx)(S.a,{className:""===this.state.errorButtonUrlMessage?"hide":"show",error:!0,size:"small",content:this.state.errorButtonUrlMessage})]})}),Object(j.jsx)(k.a.Item,{size:"size.half",children:Object(j.jsx)("div",{className:"adaptiveCardContainer"})})]}),Object(j.jsx)(k.a,{className:"footerContainer",vAlign:"end",hAlign:"end",children:Object(j.jsx)(k.a,{className:"buttonContainer",children:Object(j.jsx)(ze.a,{content:this.localize("Next"),disabled:this.isNextBtnDisabled(),id:"saveBtn",onClick:this.onNext,primary:!0})})})]})}):"AudienceSelection"===this.state.page?Object(j.jsx)("div",{className:"taskModule",children:Object(j.jsxs)(k.a,{column:!0,className:"formContainer",vAlign:"stretch",gap:"gap.small",children:[Object(j.jsxs)(k.a,{className:"scrollableContent",children:[Object(j.jsx)(k.a.Item,{size:"size.half",children:Object(j.jsxs)(k.a,{column:!0,className:"formContentContainer",children:[Object(j.jsx)("h3",{children:this.localize("SendHeadingText")}),Object(j.jsx)(Ue.a,{className:"radioBtns",checkedValue:this.state.selectedRadioBtn,onCheckedValueChange:this.onGroupSelected,vertical:!0,items:[{name:"teams",key:"teams",value:"teams",label:this.localize("SendToGeneralChannel"),children:function(t,a){var s=a.name,n=Object(Ie.a)(a,dt);return Object(j.jsxs)(k.a,{column:!0,children:[Object(j.jsx)(t,Object(De.a)({},n)),Object(j.jsx)(Be.a,{hidden:!e.state.teamsOptionSelected,placeholder:e.localize("SendToGeneralChannelPlaceHolder"),search:!0,multiple:!0,items:e.getItems(),value:e.state.selectedTeams,onChange:e.onTeamsChange,noResultsMessage:e.localize("NoMatchMessage")})]},s)}},{name:"rosters",key:"rosters",value:"rosters",label:this.localize("SendToRosters"),children:function(t,a){var s=a.name,n=Object(Ie.a)(a,ht);return Object(j.jsxs)(k.a,{column:!0,children:[Object(j.jsx)(t,Object(De.a)({},n)),Object(j.jsx)(Be.a,{hidden:!e.state.rostersOptionSelected,placeholder:e.localize("SendToRostersPlaceHolder"),search:!0,multiple:!0,items:e.getItems(),value:e.state.selectedRosters,onChange:e.onRostersChange,unstable_pinned:e.state.unstablePinned,noResultsMessage:e.localize("NoMatchMessage")})]},s)}},{name:"allUsers",key:"allUsers",value:"allUsers",label:this.localize("SendToAllUsers"),children:function(t,a){var s=a.name,n=Object(Ie.a)(a,mt);return Object(j.jsxs)(k.a,{column:!0,children:[Object(j.jsx)(t,Object(De.a)({},n)),Object(j.jsx)("div",{className:"allUsers"===e.state.selectedRadioBtn?"":"hide",children:Object(j.jsx)("div",{className:"noteText",children:Object(j.jsx)(S.a,{error:!0,content:e.localize("SendToAllUsersNote")})})})]},s)}},{name:"groups",key:"groups",value:"groups",label:this.localize("SendToGroups"),children:function(t,a){var s=a.name,n=Object(Ie.a)(a,pt);return Object(j.jsxs)(k.a,{column:!0,children:[Object(j.jsx)(t,Object(De.a)({},n)),Object(j.jsx)("div",{className:e.state.groupsOptionSelected&&!e.state.groupAccess?"":"hide",children:Object(j.jsx)("div",{className:"noteText",children:Object(j.jsx)(S.a,{error:!0,content:e.localize("SendToGroupsPermissionNote")})})}),Object(j.jsx)(Be.a,{className:"hideToggle",hidden:!e.state.groupsOptionSelected||!e.state.groupAccess,placeholder:e.localize("SendToGroupsPlaceHolder"),search:e.onGroupSearch,multiple:!0,loading:e.state.loading,loadingMessage:e.localize("LoadingText"),items:e.getGroupItems(),value:e.state.selectedGroups,onSearchQueryChange:e.onGroupSearchQueryChange,onChange:e.onGroupsChange,noResultsMessage:e.state.noResultMessage,unstable_pinned:e.state.unstablePinned}),Object(j.jsx)("div",{className:e.state.groupsOptionSelected&&e.state.groupAccess?"":"hide",children:Object(j.jsx)("div",{className:"noteText",children:Object(j.jsx)(S.a,{error:!0,content:e.localize("SendToGroupsNote")})})})]},s)}}]}),Object(j.jsx)("h3",{children:this.localize("SendOptions")}),Object(j.jsx)(Fe.a,{label:this.localize("RequestReadReceipt"),checked:!this.state.teamsOptionSelected&&this.state.selectedRequestReadReceipt,onChange:this.onRequestReadReceiptChanged,disabled:this.state.teamsOptionSelected}),Object(j.jsx)(Fe.a,{label:this.localize("DelayDelivery"),checked:this.state.selectedDelayDelivery,onChange:this.onDelayDeliveryChanged}),Object(j.jsxs)(k.a,{gap:"gap.smaller",children:[Object(j.jsx)(k.a.Item,{children:Object(j.jsx)(ut,{screenWidth:500,selectedDate:this.state.selectedScheduledDateTime,minDate:new Date,onDateSelect:this.onDeliveryDateChanged,disableSelection:!this.state.selectedDelayDelivery,theme:""})}),Object(j.jsx)(k.a.Item,{children:Object(j.jsx)(nt,{hours:void 0===this.state.selectedScheduledDateTime?0:new Date(this.state.selectedScheduledDateTime).getHours(),minutes:void 0===this.state.selectedScheduledDateTime?0:new Date(this.state.selectedScheduledDateTime).getMinutes(),isDisabled:!this.state.selectedDelayDelivery,onPickerClose:this.onDeliveryTimeChange,dir:Ye.Ltr})})]})]})}),Object(j.jsx)(k.a.Item,{size:"size.half",children:Object(j.jsx)("div",{className:"adaptiveCardContainer"})})]}),Object(j.jsx)(k.a,{className:"footerContainer",vAlign:"end",hAlign:"end",children:Object(j.jsxs)(k.a,{className:"buttonContainer",gap:"gap.small",children:[Object(j.jsx)(k.a.Item,{push:!0,children:Object(j.jsx)(z.a,{id:"sendingLoader",className:"hiddenLoader sendingLoader",size:"smallest",label:this.localize("PreparingMessageLabel"),labelPosition:"end"})}),Object(j.jsx)(k.a.Item,{push:!0,children:Object(j.jsx)(ze.a,{content:this.localize("Back"),onClick:this.onBack,secondary:!0})}),Object(j.jsx)(ze.a,{content:this.localize("SaveAsDraft"),disabled:this.isSaveBtnDisabled(),id:"saveBtn",onClick:this.onSave,primary:!0})]})})]})}):Object(j.jsx)("div",{children:"Error"})}},{key:"escFunction",value:function(e){27!==e.keyCode&&"Escape"!==e.key||m.tasks.submitTask()}}]),a}(s.Component);jt.MAX_SELECTED_TEAMS_NUM=20;var bt=Object(f.a)()(jt),gt=(a(746),a(104)),ft=a(960),Ot=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.initMessage={id:"",title:""},s.card=void 0,s.getReactionsCount=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y(t);case 3:(a=e.sent).data=B(a.data),s.setState({reactionsCount:a.data}),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),s.getItem=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K(t);case 3:(a=e.sent).data.sendingDuration=U(a.data.sendingStartedDate,a.data.sentDate),a.data.sendingStartedDate=R(a.data.sendingStartedDate),a.data.sentDate=R(a.data.sentDate),a.data.succeeded=B(a.data.succeeded),a.data.viewsCount=B(a.data.viewsCount),a.data.clicksCount=B(a.data.clicksCount),a.data.acknowledgementsCount=B(a.data.acknowledgementsCount),a.data.failed=B(a.data.failed),a.data.unknown=a.data.unknown&&B(a.data.unknown),s.setState({message:a.data}),e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(0),e.abrupt("return",e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t){return e.apply(this,arguments)}}(),s.onClose=function(){m.tasks.submitTask()},s.onExport=Object(M.a)(Object(N.a)().mark((function e(){var t;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementsByClassName("sendingLoader")[0].classList.remove("hiddenLoader"),t={id:s.state.message.id,teamId:s.state.teamId},e.next=5,$(t).then((function(){s.setState({page:"SuccessPage"})})).catch((function(){s.setState({page:"ErrorPage"})}));case 5:case"end":return e.stop()}}),e)}))),s.getItemList=function(e){var t=[];return e&&(t=e.map((function(e){return{header:e,media:Object(j.jsx)(gt.a,{src:Ke.makeInitialImage(e),avatar:!0})}}))),t},s.renderAudienceSelection=function(){return s.state.message.teamNames&&s.state.message.teamNames.length>0?Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{children:s.localize("SentToGeneralChannel")}),Object(j.jsx)(T.a,{items:s.getItemList(s.state.message.teamNames)})]}):s.state.message.rosterNames&&s.state.message.rosterNames.length>0?Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{children:s.localize("SentToRosters")}),Object(j.jsx)(T.a,{items:s.getItemList(s.state.message.rosterNames)})]}):s.state.message.groupNames&&s.state.message.groupNames.length>0?Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{children:s.localize("SentToGroups1")}),Object(j.jsx)("span",{children:s.localize("SentToGroups2")}),Object(j.jsx)(T.a,{items:s.getItemList(s.state.message.groupNames)})]}):s.state.message.allUsers?Object(j.jsx)("div",{children:Object(j.jsx)("h3",{children:s.localize("SendToAllUsers")})}):Object(j.jsx)("div",{})},s.renderErrorMessage=function(){return s.state.message.errorMessage?Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{children:s.localize("Errors")}),Object(j.jsx)("span",{children:s.state.message.errorMessage})]}):Object(j.jsx)("div",{})},s.renderWarningMessage=function(){return s.state.message.warningMessage?Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{children:s.localize("Warnings")}),Object(j.jsx)("span",{children:s.state.message.warningMessage})]}):Object(j.jsx)("div",{})},s.localize=s.props.t,s.card=He(s.props.t),s.state={message:s.initMessage,loader:!0,page:"ViewStatus",teamId:"",reactionsCount:0},s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;if(m.initialize(),m.getContext((function(t){e.setState({teamId:t.teamId})})),"id"in t){var a=t.id;this.getItem(a).then((function(){e.setState({loader:!1},(function(){_e(e.card,e.state.message.title),We(e.card,e.state.message.imageLink),Qe(e.card,e.state.message.summary),Ve(e.card,e.state.message.author),""!==e.state.message.buttonTitle&&""!==e.state.message.buttonLink&&Je(e.card,e.state.message.buttonTitle,e.state.message.buttonLink);var t=new Ae.AdaptiveCard;t.parse(e.card);var a=t.render();document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(a);var s=e.state.message.buttonLink;t.onExecuteAction=function(e){window.open(s,"_blank")}}))})),this.getReactionsCount(a)}}},{key:"render",value:function(){return this.state.loader?Object(j.jsx)("div",{className:"Loader",children:Object(j.jsx)(z.a,{})}):"ViewStatus"===this.state.page?Object(j.jsx)("div",{className:"taskModule",children:Object(j.jsxs)(k.a,{column:!0,className:"formContainer",vAlign:"stretch",gap:"gap.small",children:[Object(j.jsxs)(k.a,{className:"scrollableContent",children:[Object(j.jsx)(k.a.Item,{size:"size.half",className:"formContentContainer",children:Object(j.jsxs)(k.a,{column:!0,children:[Object(j.jsxs)("div",{className:"contentField",children:[Object(j.jsx)("h3",{children:this.localize("TitleText")}),Object(j.jsx)("span",{children:this.state.message.title})]}),Object(j.jsxs)("div",{className:"contentField",children:[Object(j.jsx)("h3",{children:this.localize("SentBy")}),Object(j.jsx)("span",{children:this.state.message.sentBy})]}),Object(j.jsxs)("div",{className:"contentField",children:[Object(j.jsx)("h3",{children:this.localize("SendingStarted")}),Object(j.jsx)("span",{children:this.state.message.sendingStartedDate})]}),Object(j.jsxs)("div",{className:"contentField",children:[Object(j.jsx)("h3",{children:this.localize("Completed")}),Object(j.jsx)("span",{children:this.state.message.sentDate})]}),Object(j.jsxs)("div",{className:"contentField",children:[Object(j.jsx)("h3",{children:this.localize("Duration")}),Object(j.jsx)("span",{children:this.state.message.sendingDuration})]}),Object(j.jsxs)("div",{className:"contentField",children:[Object(j.jsx)("h3",{children:this.localize("Results")}),Object(j.jsx)("label",{children:this.localize("Success",{SuccessCount:this.state.message.succeeded})}),Object(j.jsx)("br",{}),Object(j.jsx)("label",{children:this.localize("Views",{ViewsCount:this.state.message.viewsCount})}),Object(j.jsx)("br",{}),Object(j.jsx)("label",{children:this.localize("Clicks",{ClicksCount:this.state.message.clicksCount})}),Object(j.jsx)("br",{}),Object(j.jsx)("label",{children:this.localize("Acknowledgements",{AcknowledgementsCount:this.state.message.acknowledgementsCount})}),Object(j.jsx)("br",{}),Object(j.jsx)("label",{children:this.localize("Reactions",{ReactionsCount:this.state.reactionsCount})}),Object(j.jsx)("br",{}),Object(j.jsx)("label",{children:this.localize("Failure",{FailureCount:this.state.message.failed})}),Object(j.jsx)("br",{}),this.state.message.unknown&&Object(j.jsx)(j.Fragment,{children:Object(j.jsx)("label",{children:this.localize("Unknown",{UnknownCount:this.state.message.unknown})})})]}),Object(j.jsx)("div",{className:"contentField",children:this.renderAudienceSelection()}),Object(j.jsx)("div",{className:"contentField",children:this.renderErrorMessage()}),Object(j.jsx)("div",{className:"contentField",children:this.renderWarningMessage()})]})}),Object(j.jsx)(k.a.Item,{size:"size.half",children:Object(j.jsx)("div",{className:"adaptiveCardContainer"})})]}),Object(j.jsx)(k.a,{className:"footerContainer",vAlign:"end",hAlign:"end",children:Object(j.jsx)("div",{className:this.state.message.canDownload?"":"disabled",children:Object(j.jsxs)(k.a,{className:"buttonContainer",gap:"gap.small",children:[Object(j.jsx)(k.a.Item,{push:!0,children:Object(j.jsx)(z.a,{id:"sendingLoader",className:"hiddenLoader sendingLoader",size:"smallest",label:this.localize("ExportLabel"),labelPosition:"end"})}),Object(j.jsx)(k.a.Item,{children:Object(j.jsx)(x.a,{content:this.state.message.sendingCompleted?this.state.message.canDownload?"":this.localize("ExportButtonProgressText"):"",calloutProps:{gapSpace:0},children:Object(j.jsx)(ze.a,{icon:Object(j.jsx)(ft.a,{size:"medium"}),disabled:!this.state.message.canDownload||!this.state.message.sendingCompleted,content:this.localize("ExportButtonText"),id:"exportBtn",onClick:this.onExport,primary:!0})})})]})})})]})}):"SuccessPage"===this.state.page?Object(j.jsx)("div",{className:"taskModule",children:Object(j.jsxs)(k.a,{column:!0,className:"formContainer",vAlign:"stretch",gap:"gap.small",children:[Object(j.jsxs)("div",{className:"displayMessageField",children:[Object(j.jsx)("br",{}),Object(j.jsx)("br",{}),Object(j.jsxs)("div",{children:[Object(j.jsx)("span",{children:Object(j.jsx)(y.a,{className:"iconStyle",xSpacing:"before",size:"largest",outline:!0})}),Object(j.jsx)("h1",{children:this.localize("ExportQueueTitle")})]}),Object(j.jsx)("span",{children:this.localize("ExportQueueSuccessMessage1")}),Object(j.jsx)("br",{}),Object(j.jsx)("br",{}),Object(j.jsx)("span",{children:this.localize("ExportQueueSuccessMessage2")}),Object(j.jsx)("br",{}),Object(j.jsx)("span",{children:this.localize("ExportQueueSuccessMessage3")})]}),Object(j.jsx)(k.a,{className:"footerContainer",vAlign:"end",hAlign:"end",gap:"gap.small",children:Object(j.jsx)(k.a,{className:"buttonContainer",children:Object(j.jsx)(ze.a,{content:this.localize("CloseText"),id:"closeBtn",onClick:this.onClose,primary:!0})})})]})}):Object(j.jsx)("div",{className:"taskModule",children:Object(j.jsxs)(k.a,{column:!0,className:"formContainer",vAlign:"stretch",gap:"gap.small",children:[Object(j.jsxs)("div",{className:"displayMessageField",children:[Object(j.jsx)("br",{}),Object(j.jsx)("br",{}),Object(j.jsxs)("div",{children:[Object(j.jsx)("span",{}),Object(j.jsx)("h1",{className:"light",children:this.localize("ExportErrorTitle")})]}),Object(j.jsx)("span",{children:this.localize("ExportErrorMessage")})]}),Object(j.jsx)(k.a,{className:"footerContainer",vAlign:"end",hAlign:"end",gap:"gap.small",children:Object(j.jsx)(k.a,{className:"buttonContainer",children:Object(j.jsx)(ze.a,{content:this.localize("CloseText"),id:"closeBtn",onClick:this.onClose,primary:!0})})})]})})}}]),a}(s.Component),vt=Object(f.a)()(Ot),xt=(a(747),a(962)),kt=a(966),St=a(964),yt=a(232),Ct=(a(748),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.initMessage={id:"",title:""},s.card=void 0,s.getItem=function(){var e=Object(M.a)(Object(N.a)().mark((function e(t){var a;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z(t);case 3:a=e.sent,s.setState({message:a.data}),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),s.onSendMessage=function(){document.getElementsByClassName("sendingLoader")[0].classList.remove("hiddenLoader"),ae(s.state.message).then((function(){m.tasks.submitTask()}))},s.getItemList=function(e){var t=[];return e&&(t=e.map((function(e){return{header:e,media:Object(j.jsx)(gt.a,{src:Ke.makeInitialImage(e),avatar:!0})}}))),t},s.renderAudienceSelection=function(){return s.state.teamNames&&s.state.teamNames.length>0?Object(j.jsxs)("div",{children:[" ",Object(j.jsx)("span",{className:"label",children:s.localize("TeamsLabel")}),Object(j.jsx)(T.a,{items:s.getItemList(s.state.teamNames)})]},"teamNames"):s.state.rosterNames&&s.state.rosterNames.length>0?Object(j.jsxs)("div",{children:[" ",Object(j.jsx)("span",{className:"label",children:s.localize("TeamsMembersLabel")}),Object(j.jsx)(T.a,{items:s.getItemList(s.state.rosterNames)})]},"rosterNames"):s.state.groupNames&&s.state.groupNames.length>0?Object(j.jsxs)("div",{children:[" ",Object(j.jsx)("span",{className:"label",children:s.localize("GroupsMembersLabel")}),Object(j.jsx)(T.a,{items:s.getItemList(s.state.groupNames)})]},"groupNames"):s.state.allUsers?Object(j.jsxs)("div",{children:[Object(j.jsx)("span",{className:"label",children:s.localize("AllUsersLabel")}),Object(j.jsx)("div",{className:"noteText",children:Object(j.jsx)(S.a,{error:!0,content:s.localize("SendToAllUsersNote")})})]},"allUsers"):Object(j.jsx)("div",{})},s.localize=s.props.t,s.card=He(s.localize),s.state={message:s.initMessage,loader:!0,teamNames:[],rosterNames:[],groupNames:[],allUsers:!1,messageId:0},s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize();var t=this.props.match.params;if("id"in t){var a=t.id;this.getItem(a).then((function(){ie(a).then((function(t){e.setState({teamNames:t.data.teamNames.sort(),rosterNames:t.data.rosterNames.sort(),groupNames:t.data.groupNames.sort(),allUsers:t.data.allUsers,messageId:a},(function(){e.setState({loader:!1},(function(){_e(e.card,e.state.message.title),We(e.card,e.state.message.imageLink),Qe(e.card,e.state.message.summary),Ve(e.card,e.state.message.author),e.state.message.buttonTitle&&e.state.message.buttonLink&&Je(e.card,e.state.message.buttonTitle,e.state.message.buttonLink);var t=new Ae.AdaptiveCard;t.parse(e.card);var a=t.render();if(document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(a),e.state.message.buttonLink){var s=e.state.message.buttonLink;t.onExecuteAction=function(e){window.open(s,"_blank")}}}))}))}))}))}}},{key:"render",value:function(){return this.state.loader?Object(j.jsx)("div",{className:"Loader",children:Object(j.jsx)(z.a,{})}):Object(j.jsx)("div",{className:"taskModule",children:Object(j.jsxs)(k.a,{column:!0,className:"formContainer",vAlign:"stretch",gap:"gap.small",children:[Object(j.jsxs)(k.a,{className:"scrollableContent",gap:"gap.small",children:[Object(j.jsx)(k.a.Item,{size:"size.half",children:Object(j.jsxs)(k.a,{column:!0,className:"formContentContainer",children:[Object(j.jsx)("h3",{children:this.localize("ConfirmToSend")}),Object(j.jsx)("span",{children:this.localize("SendToRecipientsLabel")}),Object(j.jsx)("div",{className:"results",children:this.renderAudienceSelection()})]})}),Object(j.jsx)(k.a.Item,{size:"size.half",children:Object(j.jsx)("div",{className:"adaptiveCardContainer"})})]}),Object(j.jsx)(k.a,{className:"footerContainer",vAlign:"end",hAlign:"end",children:Object(j.jsxs)(k.a,{className:"buttonContainer",gap:"gap.small",children:[Object(j.jsx)(k.a.Item,{push:!0,children:Object(j.jsx)(z.a,{id:"sendingLoader",className:"hiddenLoader sendingLoader",size:"smallest",label:this.localize("PreparingMessageLabel"),labelPosition:"end"})}),Object(j.jsx)(ze.a,{content:this.localize("Send"),id:"sendBtn",onClick:this.onSendMessage,primary:!0})]})})]})})}}]),a}(s.Component)),wt=Object(f.a)()(Ct),zt=a(128),Tt=(a(809),function(e){var t=Object(at.a)().t;return Object(j.jsx)(S.a,{content:function(){var a=e.match.params;if("id"in a){var s=a.id;if("401"===s)return t("UnauthorizedErrorMessage");if("403"===s)return t("ForbiddenErrorMessage")}return t("GeneralErrorMessage")}(),className:"error-message",error:!0,size:"medium"})}),Nt=(a(810),function(e){var t=Object(at.a)().t,a=t("SignInPromptMessage");return Object(j.jsxs)("div",{className:"sign-in-content-container",children:[Object(j.jsx)(S.a,{content:a,size:"medium"}),Object(j.jsx)("div",{className:"space"}),Object(j.jsx)(ze.a,{content:t("SignIn"),primary:!0,className:"sign-in-button",onClick:function(){m.authentication.authenticate({url:window.location.origin+"/signin-simple-start",successCallback:function(){console.log("Login succeeded!"),window.location.href="/messages"},failureCallback:function(e){console.log("Login failed: "+e),window.location.href="/errorpage?locale=".concat(F.language)}})}})]})}),Mt=function(){return Object(s.useEffect)((function(){m.initialize(),m.getContext((function(e){var t=window.location.origin.replace("https://",""),a=e.upn?e.upn:"";oe(t,a).then((function(e){window.location.assign(e.data)}))}))})),Object(j.jsx)(j.Fragment,{})},Lt=function(){return Object(s.useEffect)((function(){m.initialize();var e=function(){var e={};return window.location.hash.substr(1).split("&").forEach((function(t){var a=t.split("="),s=a[0],n=a[1]&&decodeURIComponent(a[1]);e[s]=n})),e}();e.error?m.authentication.notifyFailure(e.error):e.id_token?m.authentication.notifySuccess():m.authentication.notifyFailure("UnexpectedFailure")})),Object(j.jsx)(j.Fragment,{})},Dt=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).setThemeComponent=function(){var e="rtl"===L.a.dir();return"dark"===n.state.theme?Object(j.jsx)(xt.a,{theme:kt.a,rtl:e,children:Object(j.jsx)("div",{className:"darkContainer",children:n.getAppDom()})}):"contrast"===n.state.theme?Object(j.jsx)(xt.a,{theme:St.a,rtl:e,children:Object(j.jsx)("div",{className:"highContrastContainer",children:n.getAppDom()})}):Object(j.jsx)(xt.a,{theme:yt.a,rtl:e,children:Object(j.jsx)("div",{className:"defaultContainer",children:n.getAppDom()})})},n.updateTheme=function(e){"dark"===e?n.setState({themeStyle:zt.ThemeStyle.Dark}):"contrast"===e?n.setState({themeStyle:zt.ThemeStyle.HighContrast}):n.setState({themeStyle:zt.ThemeStyle.Light})},n.getAppDom=function(){var e=Object(zt.getContext)({baseFontSize:10,style:n.state.themeStyle});return Object(j.jsx)(zt.TeamsThemeContext.Provider,{value:e,children:Object(j.jsx)(s.Suspense,{fallback:Object(j.jsx)("div",{}),children:Object(j.jsx)("div",{className:"appContainer",children:Object(j.jsx)(d.a,{children:Object(j.jsxs)(h.c,{children:[Object(j.jsx)(h.a,{exact:!0,path:"/configtab",component:b}),Object(j.jsx)(h.a,{exact:!0,path:"/messages",component:Le}),Object(j.jsx)(h.a,{exact:!0,path:"/newmessage",component:bt}),Object(j.jsx)(h.a,{exact:!0,path:"/newmessage/:id",component:bt}),Object(j.jsx)(h.a,{exact:!0,path:"/viewstatus/:id",component:vt}),Object(j.jsx)(h.a,{exact:!0,path:"/sendconfirmation/:id",component:wt}),Object(j.jsx)(h.a,{exact:!0,path:"/errorpage",component:Tt}),Object(j.jsx)(h.a,{exact:!0,path:"/errorpage/:id",component:Tt}),Object(j.jsx)(h.a,{exact:!0,path:"/signin",component:Nt}),Object(j.jsx)(h.a,{exact:!0,path:"/signin-simple-start",component:Mt}),Object(j.jsx)(h.a,{exact:!0,path:"/signin-simple-end",component:Lt})]})})})})})},n.state={theme:"",themeStyle:zt.ThemeStyle.Light},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize(),m.getContext((function(t){var a=t.theme||"";e.updateTheme(a),e.setState({theme:a})})),m.registerOnThemeChangeHandler((function(t){e.updateTheme(t),e.setState({theme:t},(function(){e.forceUpdate()}))})),function(){var e=window.location.search,t=new URLSearchParams(e).get("locale")||"en-US";L.a.changeLanguage(t),E.a.locale(t)}()}},{key:"render",value:function(){return Object(j.jsx)("div",{children:this.setThemeComponent()})}}]),a}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var It=a(181),At=Object(It.b)({messagesList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"FETCH_MESSAGES"===t.type?t.payload:e},draftMessagesList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"FETCH_DRAFTMESSAGES"===t.type?t.payload:e},selectedMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"MESSAGE_SELECTED"===t.type?t.payload:e}}),Et=a(449),Rt=Object(It.c)(At,Object(It.a)(Et.a));i.a.render(Object(j.jsx)(v.a,{store:Rt,children:Object(j.jsx)(Dt,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[814,1,2]]]);
//# sourceMappingURL=main.ea5da9d2.chunk.js.map